<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Layanan Konsultasi Agama Islam - KUA Rantepao</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      padding: 0;
      margin: 0;
      background-color: #f8f9fa;
      color: #333;
      position: relative;
    }

    /* Header Kemenag */
    .header {
      background-color: #006400;
      color: white;
      text-align: center;
      padding: 20px 0;
      border-bottom: 4px solid #32CD32;
    }

    .logo {
      width: 120px;
      height: auto;
      margin-bottom: 10px;
    }

    .title {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0;
    }

    .subtitle {
      font-size: 1rem;
      margin: 5px 0 0;
    }

    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }

    input, select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
      font-size: 1rem;
    }

    button {
      background-color: #32CD32;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      width: 100%;
      margin-top: 10px;
    }

    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }

    /* Fullscreen Overlay */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.95);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .overlay-content {
      text-align: center;
    }

    .overlay-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #32CD32;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    .overlay-text {
      font-size: 1.2rem;
      color: #333;
      font-weight: bold;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Notifikasi Sukses */
    .notification {
      display: none;
      padding: 15px;
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      border-radius: 5px;
      text-align: center;
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Header Kemenag -->
  <div class="header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Kementerian_Agama_new_logo.png" alt="Logo Kemenag" class="logo" />
    <h1 class="title">Layanan Konsultasi Agama Islam</h1>
    <p class="subtitle">KUA Kecamatan Rantepao</p>
  </div>

  <!-- Form -->
  <div class="container">
    <div class="form-group">
      <label>Tanggal Konsultasi *</label>
      <input type="date" id="tanggalKonsultasi" required />
    </div>

    <div class="form-group">
      <label>Nama Lengkap *</label>
      <input type="text" id="nama" required />
    </div>

    <div class="form-group">
      <label>Tempat, Tanggal Lahir (TTL) *</label>
      <input type="text" id="ttl" placeholder="Contoh: Rantepao, 11 Januari 2000" required />
    </div>

    <div class="form-group">
      <label>Jenis Kelamin *</label>
      <select id="jenisKelamin" required>
        <option value="">-- Pilih --</option>
        <option value="Pria">Pria</option>
        <option value="Wanita">Wanita</option>
      </select>
    </div>

    <div class="form-group">
      <label>Status Perkawinan *</label>
      <select id="statusPerkawinan" required>
        <option value="">-- Pilih --</option>
        <option value="Belum Menikah">Belum Menikah</option>
        <option value="Menikah">Menikah</option>
        <option value="Janda">Janda</option>
        <option value="Duda">Duda</option>
      </select>
    </div>

    <div class="form-group">
      <label>Alamat Lengkap *</label>
      <textarea id="alamat" rows="3" required></textarea>
    </div>

    <div class="form-group">
      <label>Pendidikan Terakhir *</label>
      <select id="pendidikan" required>
        <option value="">-- Pilih --</option>
        <option value="SD">SD</option>
        <option value="SMP">SMP</option>
        <option value="SMA">SMA</option>
        <option value="D1">D1</option>
        <option value="D2">D2</option>
        <option value="D3">D3</option>
        <option value="D4/S1">D4/S1</option>
        <option value="S2">S2</option>
        <option value="S3">S3</option>
      </select>
    </div>

    <div class="form-group">
      <label>Pekerjaan *</label>
      <input type="text" id="pekerjaan" required />
    </div>

    <div class="form-group">
      <label>Nomor HP/WA *</label>
      <input type="text" id="noHp" required />
    </div>

    <div class="form-group">
      <label>Jenis Layanan *</label>
      <select id="jenisLayanan" required>
        <option value="">-- Pilih --</option>
        <option value="Konsultasi Pra-Nikah">Konsultasi Pra-Nikah</option>
        <option value="Konsultasi Pernikahan">Konsultasi Pernikahan</option>
        <option value="Konsultasi Rujuk">Konsultasi Rujuk</option>
        <option value="Konsultasi Keluarga">Konsultasi Keluarga</option>
        <option value="Konsultasi Perceraian">Konsultasi Perceraian</option>
        <option value="Konsultasi Haji">Konsultasi Haji</option>
        <option value="Konsultasi Paham Keagamaan">Konsultasi Paham Keagamaan</option>
        <option value="Konsultasi Hisab Rukyat">Konsultasi Hisab Rukyat</option>
        <option value="Konsultasi Wakaf">Konsultasi Wakaf</option>
        <option value="Konsultasi Zakat">Konsultasi Zakat</option>
        <option value="Konsultasi Halal">Konsultasi Halal</option>
        <option value="Konsultasi Moderasi Beragama">Konsultasi Moderasi Beragama</option>
        <option value="Bimbingan Kemasjidan">Bimbingan Kemasjidan</option>
        <option value="Lainnya">Lainnya</option>
      </select>
    </div>

    <div class="form-group" id="divKeteranganLainnya" style="display:none;">
      <label>Keterangan Lainnya</label>
      <textarea id="keteranganLainnya" rows="2"></textarea>
    </div>

    <div class="form-group">
      <label>Pertanyaan / Permohonan</label>
      <textarea id="pertanyaan" rows="4"></textarea>
    </div>

    <button id="submitBtn"> Kirim </button>

    <!-- Notifikasi Sukses -->
    <div class="notification" id="notification">
      Alhamdulillah, data telah terkirim. Terima kasih atas perhatiannya.
    </div>
  </div>

  <!-- Fullscreen Overlay -->
  <div class="overlay" id="overlay">
    <div class="overlay-content">
      <div class="overlay-spinner"></div>
      <div class="overlay-text">Data Anda Sedang Dikirim...</div>
    </div>
  </div>

  <script>
    // Tampilkan/sembunyikan kolom "Keterangan Lainnya"
    document.getElementById('jenisLayanan').addEventListener('change', function() {
      const div = document.getElementById('divKeteranganLainnya');
      if (this.value === 'Lainnya') {
        div.style.display = 'block';
      } else {
        div.style.display = 'none';
        document.getElementById('keteranganLainnya').value = '';
      }
    });

   
    document.getElementById('submitBtn').addEventListener('click', async function(e) {
      e.preventDefault();

      const btn = this;
      const overlay = document.getElementById('overlay');
      const notification = document.getElementById('notification');

      overlay.style.display = 'flex';
      btn.disabled = true;

      const data = {
        "Tanggal Konsultasi": document.getElementById('tanggalKonsultasi').value,
        "Nama": document.getElementById('nama').value,
        "TTL": document.getElementById('ttl').value,
        "Jenis Kelamin": document.getElementById('jenisKelamin').value,
        "Status Perkawinan": document.getElementById('statusPerkawinan').value,
        "Alamat": document.getElementById('alamat').value,
        "Pendidikan": document.getElementById('pendidikan').value,
        "Pekerjaan": document.getElementById('pekerjaan').value,
        "No HP": document.getElementById('noHp').value,
        "Jenis Layanan": document.getElementById('jenisLayanan').value,
        "Keterangan Lainnya": document.getElementById('keteranganLainnya').value || "-",
        "Pertanyaan": document.getElementById('pertanyaan').value || "-"
      };

      try {
        const response = await fetch('https://sheetdb.io/api/v1/llc0xyydb53zl', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();

        if (response.ok && result.created > 0) {
          overlay.style.display = 'none';
          notification.style.display = 'block';

          
          setTimeout(() => {
            notification.style.display = 'none';
            location.reload(); 
          }, 2000);

        } else {
          throw new Error(result.error || "Gagal menyimpan data");
        }
      } catch (error) {
        overlay.style.display = 'none';
        btn.disabled = false;
        alert("‚ùå Error: " + error.message);
      }
    });
  </script>
</body>
</html>
